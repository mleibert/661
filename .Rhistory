x=3
y=1:10000000
sum((x^y*exp(-2*x))/factorial(y))
y=1:100
sum((x^y*exp(-2*x))/factorial(y))
y=1:1001
sum((x^y*exp(-2*x))/factorial(y))
f<-function(x){(x^y * exp(-2*x))/y!}
f<-function(x){(x^y * exp(-2*x))/factorial(y)}
integrate(f,0,INF)
integrate(f,0,Inf)
warning(
)
warnings()
g<-function(z){z^2}
integrate(g,0,4)
y=1
integrate(f,0,Inf)
y=0
integrate(f,0,Inf)
y=1:10-
integrate(f,0,Inf)
y=1:10
integrate(f,0,Inf)
fy<-rep(NA,20)
fy<-rep(NA,20)
for(y in 1:20){  fy[i]<-integrate(f,0,Inf)}
fy<-rep(NA,20)
for(y in 1:20){  fy[y]<-integrate(f,0,Inf)}
fy
sum(fy)
y=1
fy[y]<-integrate(f,0,Inf)
integrate(f,0,Inf)
as.numeric(integrate(f,0,Inf))
integrate(f,0,Inf)
str(integrate(f,0,Inf))
integrate(f,0,Inf)[[1]]
fy<-rep(NA,20)
for(y in 1:20){  fy[y]<-integrate(f,0,Inf)[[1]]}
sum(fy)
Q
Q<-1:100
fy<-rep(NA,Q)
for(y in 1:Q){  fy[y]<-integrate(f,0,Inf)[[1]]}
sum(fy)
Q<-1:100
fy<-rep(NA,Q)
fy
Q<-100
fy<-rep(NA,Q)
for(y in 1:Q){  fy[y]<-integrate(f,0,Inf)[[1]]}
sum(fy)
fy
Q<-1001
fy<-rep(NA,Q)
for(y in 1:Q){  fy[y]<-integrate(f,0,Inf)[[1]]}
Q<-500
fy<-rep(NA,Q)
for(y in 1:Q){  fy[y]<-integrate(f,0,Inf)[[1]]}
sum(fy)
y=1
fy[y]<-integrate(f,0,Inf)[[1]]
fy[y]
Q<-10
fy<-rep(NA,Q)
for(y in 1:Q){  fy[y]<-integrate(f,0,Inf)[[1]] ;print(fy[y]) }
sum(fy)
f<-function(x){(x^y * exp(-1*x))/factorial(y)}
Q<-10
fy<-rep(NA,Q)
for(y in 1:Q){  fy[y]<-integrate(f,0,Inf)[[1]] ;print(fy[y]) }
sum(fy)
f<-function(x){(x^y * exp(-2*x))/factorial(y)}
Q<-10
fy<-rep(NA,Q)
for(y in 1:Q){  fy[y]<-integrate(f,0,Inf)[[1]] ;print(fy[y]) }
sum(fy)
a=1
f<-function(x){(x^(a+y-1) * exp(-2*x))/factorial(y)}
Q<-10
fy<-rep(NA,Q)
for(y in 1:Q){  fy[y]<-integrate(f,0,Inf)[[1]] ;print(fy[y]) }
sum(fy)
gamma(1)
a^b
b=1
a^b
Q<-10*2
fy<-rep(NA,Q)
for(y in 1:Q){  fy[y]<-integrate(f,0,Inf)[[1]] ;print(fy[y]) }
sum(fy)
install.packages(c("cowplot", "git2r", "lme4", "rlang", "rprojroot", "tibble", "withr"))
install.packages(c("MASS", "rpart"), lib="C:/Program Files/R/R-3.3.2/library")
getwd()
times<-rep(NA,10)
for ( i in 1:10) {
times[i]<-system.time( for ( j in 1:(10^i) ) { 1*1 } )[1]
if ( times[i] > 1 ) { break}
}
system.time( for( i in 1: (1/times[7] * 10^7) ) { 1*1} )
knitr::opts_chunk$set(echo = TRUE)
1/times[7] * 10^7
install.packages("RCurl")
head(B)
library(RCurl)
dat <- getURL("https://raw.githubusercontent.com/mleibert/504/master/economic_data.txt")
dat <- read.table(text = dat ,header=T)
options(scipen = 999)
y<-dat[,ncol(dat)]
B<-as.matrix(dat[,2:(ncol(dat)-1)])
B<-cbind(1,B)
#solve(t(B) %*% B ) %*% t(B) %*% y
head(B)
dat<-dat[,-1]
( lm(B~.,data=dat) )
head(B)
dat<-dat[,-1]
( lm(y~.,data=dat) )
head(B);head(dat)
dat<-dat[,-1]
( lm(y~.,data=dat) )
head(B);head(dat)
dat<-dat[,-1]
( lm(B~.,data=dat) )
head(B);head(dat)
dat<-dat[,-1]
( lm(B~.,data=dat) )
library(RCurl)
dat <- getURL("https://raw.githubusercontent.com/mleibert/504/master/economic_data.txt")
dat <- read.table(text = dat ,header=T)
options(scipen = 999)
y<-dat[,ncol(dat)]
B<-as.matrix(dat[,2:(ncol(dat)-1)])
B<-cbind(1,B)
#solve(t(B) %*% B ) %*% t(B) %*% y
head(B);head(dat)
dat<-dat[,-1]
( lm(B~.,data=dat) )
library(RCurl)
dat <- getURL("https://raw.githubusercontent.com/mleibert/504/master/economic_data.txt")
dat <- read.table(text = dat ,header=T)
options(scipen = 999)
y<-dat[,ncol(dat)]
B<-as.matrix(dat[,2:(ncol(dat)-1)])
B<-cbind(1,B)
#solve(t(B) %*% B ) %*% t(B) %*% y
cor(B[,-1])
BB<-B[,-c(7,6)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
cor(B[,-1])
BB<-B[,-c(2)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
BB<-B[,-c(5)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
BB<-B[,-c(6)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
BB<-B[,-c(7)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
BB<-B[,-c(8)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
BB<-B[,-c(9)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
B
BB<-B[,-c(6,7)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
( lm(B~.,data=dat) )
dat
as.data.frame(dat)
dat<-dat[,-1]
( lm(B~.,data=dat) )
dat
as.data.frame(dat)
BB
BB
dat
BB
dat
BB
( lm(B~.,data=BB) )
BB
dat
BB<-as.data.frame(BB)
( lm(B~.,data=BB) )
BB
head(BB)
library(RCurl)
dat <- getURL("https://raw.githubusercontent.com/mleibert/504/master/economic_data.txt")
dat <- read.table(text = dat ,header=T)
options(scipen = 999)
y<-dat[,ncol(dat)]
B<-as.matrix(dat[,2:(ncol(dat)-1)])
B<-cbind(1,B)
#solve(t(B) %*% B ) %*% t(B) %*% y
cor(B[,-1])
BB<-B[,-c(6,7)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
dat<-dat[,-1]
( lm(B~.,data=dat) )
BB<-BB[,-1]
BB$B<-dat$B
BB<-as.data.frame(BB)
BB
library(RCurl)
dat <- getURL("https://raw.githubusercontent.com/mleibert/504/master/economic_data.txt")
dat <- read.table(text = dat ,header=T)
options(scipen = 999)
y<-dat[,ncol(dat)]
B<-as.matrix(dat[,2:(ncol(dat)-1)])
B<-cbind(1,B)
#solve(t(B) %*% B ) %*% t(B) %*% y
cor(B[,-1])
BB<-B[,-c(6,7)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
BB
BB<-BB[,-1]
BB
BB<-as.data.frame(BB)
BB$B<-dat$B
BB
( lm(B~.,data=BB) )
( lm(B~.,data=dat) )
getwd()
x
getwd()
read.table("g:/504")
OR<-read.table("g:/504/o_ring_data.txt",header=T)
x<-OR[,1];y<-OR[,2]
f1<-function(a0,a1,x,y){ sum(exp(-a0-a1*x)/(1+exp(-a0-a1*x))-(1-y))  }
f2<-function(a0,a1,x,y){sum(-x*exp(-a0-a1*x)/(1+exp(-a0-a1*x))-x*(1-y))}
f1(0,0,x,y)
f2(0,0,x,y)
x
y
f1(0,0,x,y)
f2(0,0,x,y)
dlda0<-function(a0,a1,x,y){
sum( ((1)/(exp(a0+a1*x))) + y -1
)}
dlda1<-function(a0,a1,x,y){
sum( ((x)/(exp(a0+a1*x)+1))	+ x * (y-1)
)}
dlda0(0,0,x,y)
dlda1(0,0,x,y)
f1(0,0,x,y)
f2(0,0,x,y)
f1(0,0,x,y)
f2(0,0,x,y)
dlda0(0,0,x,y)
dlda1(0,0,x,y)
sum( ((1)/(exp(a0+a1*x))) + y -1
)
dlda0<-function(a0,a1,x,y){
sum(exp(-a0-a1*x)/(1+exp(-a0-a1*x))-(1-y))  )}
dlda0<-function(a0,a1,x,y){
sum(exp(-a0-a1*x)/(1+exp(-a0-a1*x))-(1-y))  }
dlda1<-function(a0,a1,x,y){
sum( ((x)/(exp(a0+a1*x)+1))	+ x * (y-1)
)}
dlda0(0,0,x,y)
f1(0,0,x,y)
dlda0<-function(a0,a1,x,y){
sum( ((1)/(exp(a0+a1*x))) + y -1
)}
dlda0(0,0,x,y)
dlda0(0,0,x,y)
dlda1(0,0,x,y)
f1(0,0,x,y)
f2(0,0,x,y)
dlda0(0,0,x,y)
f1(0,0,x,y)
dlda1<-function(a0,a1,x,y){
sum( ((x)/(exp(a0+a1*x)+1))	+ y * (y-1)
)}
dlda0(0,0,x,y)
dlda1(0,0,x,y)
dlda0<-function(a0,a1,x,y){
sum( ((1)/(exp(a0+a1*x)+1)) + y -1
)}
dlda0(0,0,x,y)
dlda1(0,0,x,y)
dlda1<-function(a0,a1,x,y){
sum( ((x)/(exp(a0+a1*x)+1))	+ x * (y-1)
)}
dlda0(0,0,x,y)
dlda1(0,0,x,y)
dlda1<-function(a0,a1,x,y){
sum( ((-x)/(exp(a0+a1*x)+1))	+ x * (y-1)
)}
dlda0(0,0,x,y)
dlda1(0,0,x,y)
f1(0,0,x,y)
f2(0,0,x,y)
glm(Failure~Temp, data=OR, family = "binomial")
curve( 1/(1+exp(-15.0429+0.2322)), from=53, to=85, add=TRUE)
curve( 1/(1+exp(-15.0429+0.2322*x)), from=53, to=85, add=TRUE)
plot( 1/(1+exp(-15.0429+0.2322*x)), from=53, to=85, add=TRUE)
curve( 1/(1+exp(-15.0429+0.2322*x)), from=53, to=85, add=TRUE)
plot(x,y)
curve( 1/(1+exp(-15.0429+0.2322*x)), from=53, to=85, add=TRUE)
x
fxy<-function(x,y){ 100*(y-x^2)^2 + (1-x)^2 }
dfdx<-function(x,y){ -400*x*y+400*x^3  + 2*x - 2 }
dfdy<-function(x,y){ 200*y - 200 * x^2  }
x<-y<-4
i=0
repeat{
x1<-x-dfdx(x,y)*.0003
y1<-y-dfdy(x,y)*.0003
x<-x1;y<-y1
i=i+1
if( (1-10^-4 < x & x < 1+10^-4) & (1-10^-4 < y & y < 1+10^-4) ){break}
}
x;y;i
fxy<-function(x,y){ 100*(y-x^2)^2 + (1-x)^2 }
dfdx<-function(x,y){ -400*x*y+400*x^3  + 2*x - 2 }
dfdy<-function(x,y){ 200*y - 200 * x^2  }
x<-y<-4
i=2
repeat{
x1<-x-dfdx(x,y)*.0003
y1<-y-dfdy(x,y)*.0003
x<-x1;y<-y1
i=i+1
if( (1-10^-4 < x & x < 1+10^-4) & (1-10^-4 < y & y < 1+10^-4) ){break}
}
x;y;i
x<-y<-4;
i=1
repeat{
di<-c(dfdx(x,y) ,dfdy(x,y))
di<- (  di/(sqrt(sum(di^2)) ) )
si<-1
while( fxy(x,y) <  fxy(  x-si*di[1], y-si*di[2])  ) {
si<-si/2 }
x<-x-di[1]*si
y<-y-di[2]*si
i=i+1
if( (1-10^-4 < x & x < 1+10^-4) & (1-10^-4 < y & y < 1+10^-4) ){break}
}
x;y;i
Hessian <- function(alpha, x, y) {
# exp(-alpha_0 - alpha_1*x_1) is used several times
exp_alpha <- exp(-alpha[1] - alpha[2]*x)
# second partial with respect to alpha_0
ddf_a0a0 <- -exp_alpha/((1+exp_alpha)^2)
#second partial with respect to alpha_0, alpha_1
ddf_a0a1 <- -x*exp_alpha/((1+exp_alpha)^2)
#second partial with respect to alpha_1, alpha_0
ddf_a1a0 <- ddf_a0a1
# second partial with respect to alpha_1
ddf_a1a1 <- (-exp_alpha*x^2)/((1+exp_alpha)^2)
# sum across N = 23
ddf_a0a0 <- sum(ddf_a0a0)
ddf_a0a1 <- sum(ddf_a0a1)
ddf_a1a0 <- sum(ddf_a1a0)
ddf_a1a1 <- sum(ddf_a1a1)
return (matrix(c(ddf_a0a0, ddf_a0a1, ddf_a1a0, ddf_a1a1),  ncol =2))
}
H <- Hessian(results$coefficients, x, y)
H <- Hessian(15.0429016, -0.2321627, x, y)
OR<-read.table("G:\\504\\o_ring_data.txt",header=T)
H <- Hessian(15.0429016, -0.2321627, OR[,1], OR[,2])
H <- Hessian(c(15.0429016, -0.2321627), OR[,1], OR[,2])
H
alpha<-as.vector(coef( glm(OR[,2]~ OR[,1], family="binomial") ))
alpha
exp_alpha <- exp(-alpha[1] - alpha[2]*x)
x<-OR[,1]
exp_alpha <- exp(-alpha[1] - alpha[2]*x)
ddf_a0a0 <- -exp_alpha/((1+exp_alpha)^2)
exp_alpha
ddf_a0a0 <- -exp_alpha/((1+exp_alpha)^2)
ddf_a0a1 <- -x*exp_alpha/((1+exp_alpha)^2)
ddf_a1a0 <- ddf_a0a1
ddf_a1a1 <- (-exp_alpha*x^2)/((1+exp_alpha)^2)
ddf_a0a0 <- sum(ddf_a0a0)
ddf_a0a1 <- sum(ddf_a0a1)
ddf_a1a0 <- sum(ddf_a1a0)
ddf_a1a1 <- sum(ddf_a1a1)
ddf_a1a0
ddf_a0a1
ddf_a0a0
ddf_a1a1
exp_alpha <- exp(-alpha[1] - alpha[2]*x)
ddf_a0a0 <- -exp_alpha/((1+exp_alpha)^2)
ddf_a0a0
ddf_a0a0
exp_alpha
OR<-read.table("G:\\504\\o_ring_data.txt",header=T)
a<-c(0,0);x<-OR[,1];y<-OR[,2]
ddf_a0a0 <- -exp_alpha/((1+exp_alpha)^2)
exp_alpha <- exp(-alpha[1] - alpha[2]*x)
alpha<-as.vector(coef( glm(OR[,2]~ OR[,1], family="binomial") ))
exp_alpha <- exp(-alpha[1] - alpha[2]*x)
ddf_a0a0 <- -exp_alpha/((1+exp_alpha)^2)
ddf_a0a1 <- -x*exp_alpha/((1+exp_alpha)^2)
ddf_a0a0
ddf_a0a0 <- -exp_alpha/((1+exp_alpha)^2) ;sum(ddf_a0a0)
ddf_a0a1 <- -x*exp_alpha/((1+exp_alpha)^2)
sum(ddf_a0a1)
ddf_a0a0 <- -exp_alpha/((1+exp_alpha)^2) ;sum(ddf_a0a0)
ddf_a0a1 <- -x*exp_alpha/((1+exp_alpha)^2)
ddf_a1a0 <- ddf_a0a1
ddf_a1a1 <- (-exp_alpha*x^2)/((1+exp_alpha)^2)
ddf_a1a1 <- sum(ddf_a1a1)
ddf_a1a1
rm(list = ls())
setwd("G:\\math\\661")
crabs<-read.table("G:\\math\\661\\crabs.txt",header=T)
crabs$color<-as.factor(CRABS$color)
rm(list = ls())
setwd("G:\\math\\661")
crabs<-read.table("G:\\math\\661\\crabs.txt",header=T)
crabs$color<-as.factor(crabs$color)
crabs$y<-ifelse(crabs$satellite > 0, 1,0)
crabs<-crabs[,c(2,4,ncol(crabs))]
crab.glm<-glm( y~.,data=crabs ,family="binomial" )
glm( y~weight+factor(color),data=crabs ,family="binomial" )
summary(crab.glm)
crabby.glm<-glm(y~weight,data=crabs ,family="binomial" )
summary(crabby.glm)
rm(list = ls())
setwd("G:\\math\\661")
crabs<-read.table("G:\\math\\661\\crabs.txt",header=T)
crabs$color<-as.factor(crabs$color)
crabs$y<-ifelse(crabs$satellite > 0, 1,0)
crabs<-crabs[,c(2,4,ncol(crabs))]
crab.glm<-glm( y~.,data=crabs ,family="binomial" )
glm( y~weight+factor(color),data=crabs ,family="binomial" )
summary(crab.glm)
library(ResourceSelection)
install.packages("ResourceSelection")
library(ResourceSelection)
library(ResourceSelection)
hoslem.test(crab.glm$y,fitted(crab.glm))
library(ResourceSelection)
res<-hoslem.test(crab.glm$y,fitted(crab.glm))
cbind(res$observed,res$expected)
library(ResourceSelection)
res<-hoslem.test(crab.glm$y,fitted(crab.glm))
res
cbind(res$observed,res$expected)
head(crab)
head(crabs)
max(crabs$weight)
getwd()
