exp(1.45936)
#males
exp(1.45936+0.30850)
1/(0.5019 - 1.96 * 0.0387)
#females
exp(1.45936)
#males
exp(1.45936+0.30850)
4.303205 + 1/(0.5019) * 4.303205 ^2
5.858303 + 1/(0.5019) * 5.858303 ^2
library(AER)
install.packages("AER"")
install.packages("AER)
install.packages("AER")
install.packages("AER")
install.packag
require("AER")
require("AER")
UGdat<-as.data.frame(lapply(dat, function(x,p) rep(x,p), dat[["counts"]]))
dispersiontest(dat.fit)
1-pchisq(600.60,43)
1-pchisq(600.60,43)
suppressWarnings(suppressMessages(library(pscl)))
fit.zip = zeroinfl(response ~ gender |  1 ,data=UGdat)
UGdat<-as.data.frame(lapply(dat, function(x,p) rep(x,p), dat[["counts"]]))
dat<-read.csv("sex.csv")
dat<-data.frame(
(rep(dat$Response,2)),
c(dat$Male,dat$Female),
as.factor(c(rep(1,nrow(dat)),rep(0,nrow(dat))))	)
names(dat)<-c("response","counts","gender")
str(dat)
cbind(head(dat) ,tail(dat))
UGdat<-as.data.frame(lapply(dat, function(x,p) rep(x,p), dat[["counts"]]))
fit.zip = zeroinfl(response ~ gender |  1 ,data=UGdat)
summary(fit.zip )
#mixing proportions
phi=as.numeric( exp(coef(fit.zip)[3])/(1+exp(coef(fit.zip)[3])) )
phi;1-phi
install.packages("emojifont")
library(emojifont)
library(emojifont)
install.packages("devtools")
devtools::install_github("GuangchuangYu/emojifont")
library(emojifont)
set.seed(123)
x <- rnorm(10)
set.seed(321)
y <- rnorm(10)
plot(x, y, cex=0)
text(x, y, labels=emoji('cow'), cex=1.5, col='steelblue', family='EmojiOne')
set.seed(123)
x <- rnorm(10)
set.seed(321)
y <- rnorm(10)
plot(x, y, cex=0)
text(x, y, labels=emoji('cow'), cex=1.5, col='steelblue', family='EmojiOne')
text(x, y, labels=emoji('cow'), cex=1.5, col='steelblue', family='EmojiOne')
library(showtext)
install.packages("showtext")
install.packages("showtext")
library(showtext)
text(x, y, labels=emoji('cow'), cex=1.5, col='steelblue', family='EmojiOne')
library(emojifont)
text(x, y, labels=emoji('cow'), cex=1.5, col='steelblue', family='EmojiOne')
text(x, y, labels=emoji('cow'), cex=1.5, col='steelblue', family='EmojiOne')
library(emojifont)
plot( ( smokers.fit$linear.predictors[1:5] )  - log(smokers$PersonYears)[1:5],
ylim=c(-8,-3.75) )
tab<-cbind(dat[which(dat$gender == 0),],dat[which(dat$gender == 1 ),-1])
setwd("G:\\math\\661")
dat<-read.csv("sex.csv")
dat<-data.frame(
(rep(dat$Response,2)),
c(dat$Male,dat$Female),
as.factor(c(rep(1,nrow(dat)),rep(0,nrow(dat))))	)
names(dat)<-c("response","counts","gender")
str(dat)
cbind(head(dat) ,tail(dat))
dat.fit<-glm(response ~ gender, family=poisson, weights=counts, data=dat)
summary(dat.fit)
tab<-cbind(dat[which(dat$gender == 0),],dat[which(dat$gender == 1 ),-1])
tab<-tab[,c(1,2,4)];tab[19,2]<-sum(tab[19:nrow(tab),2]);
tab[19,3]<-sum(tab[19:nrow(tab),3]);tab<-tab[1:19,]
names(tab)[2:3]<-c("Female","Male")
head(tab)
c(sum(tab[,2]),sum(tab[,1]*tab[,2]));    sum(tab[,1]*tab[,2])/sum(tab[,2])
sum( tab[,2]*((tab[,1]- 4.183871 )^2) ) / ( sum(tab[,2]) -1)
c(sum(tab[,3]),sum(tab[,1]*tab[,3]));    sum(tab[,1]*tab[,3])/sum(tab[,3])
sum( tab[,3]*((tab[,1]- 4.183871 )^2) ) / ( sum(tab[,3]) -1)
1-pchisq(3985.7,43)
tab<-cbind(dat[which(dat$gender == 0),],dat[which(dat$gender == 1 ),-1])
tab<-tab[,c(1,2,5)]
names(tab)[2:3]<-c("Female","Male");head(tab)
sex.n = by(dat$counts, dat$gender, sum)
sex.nb = glm.nb(response ~ gender, weights=counts, data=dat)
dat[which(dat$gender == 0),],dat[which(dat$gender == 1 ),-1]
dat
dat
dat
dat[which(dat$gender == 0),]
datt
tab
dat
tab<-cbind(dat[which(dat$gender == 0),],dat[which(dat$gender == 1 ),-1])
tab
sex.nb$theta
require(ggplot2)
UU<-data.frame(apply(U , 1, function(z) Norm(z-as.numeric(U[ 500,]) )^2),	1:length(UU))
U<-as.data.frame(sdat$u[,1:2]);V<-as.data.frame(sdat$v[,1:2] )
sdat<-svd(as.matrix(dat))
options(width = 1111)
setwd("G:\\math\\504")
setwd("G:\\math\\504")
options(scipen=999)
Norm <- function(w){  sqrt(sum(w^2))}
require(ggplot2)
dat<-read.table("user-shows.txt")
shows<-read.table("shows.txt")
alex<-read.table("alex.txt");colnames(alex)<-as.vector(shows$V1)
sdat<-svd(as.matrix(dat))
par(mar=c(5.1,4.1,2.1,2.1))
plot(sdat[[1]])
head( sum(sdat[[1]])-cumsum(sdat[[1]]) ); tail(sum(sdat[[1]])-cumsum(sdat[[1]]))
plot(sdat[[1]],xlim=c(0,20))
U<-as.data.frame(sdat$u[,1:2]);V<-as.data.frame(sdat$v[,1:2] )
UU<-data.frame(apply(U , 1, function(z) Norm(z-as.numeric(U[ 500,]) )^2),	1:length(UU))
U<-as.data.frame(sdat$u[,1:2]);V<-as.data.frame(sdat$v[,1:2] )
UU<-data.frame(apply(U , 1, function(z) Norm(z-as.numeric(U[ 500,]) )^2),	1:length(U))
U<-as.data.frame(sdat$u[,1:2]);V<-as.data.frame(sdat$v[,1:2] )
UU<-data.frame(apply(U , 1, function(z) Norm(z-as.numeric(U[ 500,]) )^2),	1:nrow(U))
buddies<-order(UU[,1])[ 2:10]
ggplot(U,aes(V1,V2)) + geom_point() +  geom_point(data=U[500,], colour="red") +
geom_point(data=U[buddies,], colour="green")
Mr<-read.table("mr.txt")
Mr
Mr<-read.table("mr.txt");Mr<-as.numeric(Mr)
Mr
Mr<-read.table("mr.txt");Mr<-as.numeric(Mr[,1])
Mr
recommend<-dat[buddies,]
recommend
recommend<-rbind(recommend,colSums(recommend))
colnames( recommend[ 10,which( recommend[10, ] > 15 )] )
recommend
recommend
head(dat)
colnames(dat)<-as.vector(shows$V1)
head(dat)
recommend<-dat[buddies,]
recommend<-rbind(recommend,colSums(recommend))
recommend
colnames( recommend[ 10,which( recommend[10, ] > 15 )] )
colnames( recommend[ 10,which( recommend[10, ] > 1 )] )
colnames( recommend[ 10,which( recommend[10, ] > 8 )] )
buddies
buddies<-order(UU[,1])[ 2:30]
recommend<-dat[buddies,]
recommend<-rbind(recommend,colSums(recommend))
colnames( recommend[ 10,which( recommend[10, ] > 8 )] )
colnames( recommend[ 10,which( recommend[10, ] > 5 )] )
colnames( recommend[ 10,which( recommend[10, ] > 3 )] )
colnames( recommend[ 10,which( recommend[10, ] > 1 )] )
colnames( recommend[ 10,which( recommend[10, ] > 2 )] )
recommend<-rbind(recommend,colSums(recommend))
recommend<-dat[buddies,]
recommend<-rbind(recommend,colSums(recommend))
recommend
colnames( recommend[ 10,which( recommend[10, ] > 2 )] )
recommend<-dat[buddies,]
setwd("G:\\math\\504")
options(scipen=999)
Norm <- function(w){  sqrt(sum(w^2))}
require(ggplot2)
dat<-read.table("user-shows.txt")
shows<-read.table("shows.txt")
alex<-read.table("alex.txt");colnames(alex)<-as.vector(shows$V1)
sdat<-svd(as.matrix(dat))
par(mar=c(5.1,4.1,2.1,2.1))
plot(sdat[[1]])
head( sum(sdat[[1]])-cumsum(sdat[[1]]) ); tail(sum(sdat[[1]])-cumsum(sdat[[1]]))
plot(sdat[[1]],xlim=c(0,20))
U<-as.data.frame(sdat$u[,1:2]);V<-as.data.frame(sdat$v[,1:2] )
UU<-data.frame(apply(U , 1, function(z) Norm(z-as.numeric(U[ 500,]) )^2),	1:nrow(U))
buddies<-order(UU[,1])[ 2:30]
ggplot(U,aes(V1,V2)) + geom_point() +    geom_point(data=U[buddies,], colour="green") +
geom_point(data=U[500,], colour="red")
ggplot(U,aes(V1,V2)) + geom_point() +    geom_point(data=U[500,], colour="red")+    xlim(-0.008173631-.001, -0.008173631+.001)  +
ylim(-0.0008980471-.001, -0.0008980471+.001) + geom_point(data=U[buddies,], colour="green")
colnames(dat)<-as.vector(shows$V1)
recommend<-dat[buddies,]
recommend<-rbind(recommend,colSums(recommend))
ggplot(V,aes(V1,V2)) + geom_point() +
geom_point(data=V[ which(dat[500,] == 1),], colour="red")  +
geom_point(data=V[ Mr,], colour="green")
Mr<-read.table("mr.txt");Mr<-as.numeric(Mr[,1])
ggplot(V,aes(V1,V2)) + geom_point() +
geom_point(data=V[ which(dat[500,] == 1),], colour="red")  +
geom_point(data=V[ Mr,], colour="green")
colnames( recommend[ 10,which( recommend[10, ] > 2 )] )
recommend
colnames( recommend[ nrow(recommend),which( recommend[10, ] > 2 )] )
head(recommend)
tail(recommend)
recommend[,which( recommend[10, ] > 15 )]
recommend[30,which( recommend[10, ] > 15 )]
recommend[ ,which( recommend[10, ] > 15 )]
which( recommend[10, ] > 15 )
recommend[ ,which( recommend[30, ] > 15 )]
colnames(recommend[ ,which( recommend[30, ] > 15 )])
ggplot(V,aes(V1,V2)) + geom_point() +
geom_point(data=V[ which(dat[500,] == 1),], colour="red")  +
geom_point(data=V[ Mr,], colour="green")
colnames(recommend[ ,which( recommend[30, ] > 14 )])
length( colnames(recommend[ ,which( recommend[30, ] > 14 )]) )
colnames(recommend[ ,which( recommend[30, ] > 14 )])
colnames(recommend[ ,which( recommend[30, ] > 14 )])[-c(1,3)]
data.frame(colnames(recommend[ ,which( recommend[30, ] > 14 )])[-c(1,3)]  )
rm(list = ls())
setwd("G:\\math\\661")
options(scipen=999)
require(ggplot2)
cheese<-read.table("cheese.txt",header=T)
cheese.ungrp = as.data.frame(lapply(cheese, function(x,p) rep(x,p), cheese$count))
cheesy<-as.data.frame(cbind(c(1:4),cheese.mat),stringsAsFactors=F)
cheese.mat<-matrix(NA,4,9)
cheese.mat[1,]<-cheese[ 1:9,3]
cheese.mat[2,]<-cheese[ 10:18,3]
cheese.mat[3,]<-cheese[ 19:27,3]
cheese.mat[4,]<-cheese[ 28:36,3]
cheesy<-as.data.frame(cbind(c(1:4),cheese.mat),stringsAsFactors=F)
cheesy
names(cheesy)<-c("type",paste0("Y",1:9))
str(cheesy)
summary( polr(as.factor(response) ~ type, weights=count, data=cheese.ungrp) )
require(ggplot2);library(MASS);library(VGAM)
summary( polr(as.factor(response) ~ type, weights=count, data=cheese.ungrp) )
data.frame(rep(1,4))
data.frame(t(rep(1,4)))
dat
data.frame
dat<-data.frame(t(rep(1,4)))
dat<-data.frame(t(rep(1,4)))
dat[1,]<-1,1,88,16,2
dat[2,]<-1,0,54,7,5
dat[3,]<-0,1,397,141,24
dat[4,]<-0,0,235,189,39
dat<-data.frame(t(rep(1,4)))
dat[1,]<-c(1,1,88,16,2)
dat[2,]<-c(1,0,54,7,5)
dat[3,]<-c(0,1,397,141,24)
dat[4,]<-c(0,0,235,189,39)
dat<-data.frame(t(rep(1,4)))
dat<-data.frame(t(rep(1,5)))
dat[1,]<-c(1,1,88,16,2)
dat[2,]<-c(1,0,54,7,5)
dat[3,]<-c(0,1,397,141,24)
dat[4,]<-c(0,0,235,189,39)
dat
names(dat)<-c("race" ,"gender", "y1", "y2", "y3")
dat
summary(vglm(cbind(y1,y2,y3) ~ gender+race, family=cumulative(parallel=T)))
summary(vglm(cbind(y1,y2,y3) ~ gender+race, family=cumulative(parallel=T)),data=dat)
summary(vglm(cbind(y1,y2,y3) ~ gender+race, family=cumulative(parallel=T),data=dat)
)
summary(vglm(cbind(y1,y2,y3) ~ gender+race, family=cumulative(parallel=T),data=dat) )
(vglm(cbind(y1,y2,y3) ~ gender+race, family=cumulative(parallel=T),data=dat) )
dat
library(reshape2)
melt(dat, id = c("Y1", "Y2","Y3"))
melt(dat, id = c("y1", "y2","y3"))
dat
head(cheese)
head(cheese.ungrp)
cheese.ungrp
dat
dat.ungrp<-data.frame(rep(1,sum(dat[1,3:5])))
dat.ungrp
90+16
dat.ungrp<-data.frame(rep(1,sum(dat[1,3:5])),rep(1,sum(dat[1,3:5]))
)
dat.ungrp
dat.ungrp<-data.frame(rep(1,sum(dat[1,3:5])),rep(1,sum(dat[1,3:5]))
rep(NA,sum(dat[1,3:5])))
dat.ungrp<-data.frame(rep(1,sum(dat[1,3:5])),rep(1,sum(dat[1,3:5])),
rep(NA,sum(dat[1,3:5])))
dat.ungrp
dat
dat.ungrp[,3]<-c(rep(1,88),rep(2,16),rep(3,2))
dat
rbind(dat.ungrp,
data.frame(rep(1,sum(dat[1,3:5])),rep(0,sum(dat[1,3:5])),
rep(NA,sum(dat[1,3:5]))))
dat
dat.bf<-data.frame(rep(1,sum(dat[1,3:5])),rep(1,sum(dat[1,3:5])),
rep(NA,sum(dat[1,3:5])))
dat.bf[,3]<-c(rep(1,88),rep(2,16),rep(3,2))
dat.bf<-data.frame(rep(1,sum(dat[1,3:5])),rep(1,sum(dat[1,3:5])),
rep(NA,sum(dat[1,3:5])))
dat.bf[,3]<-c(rep(1,88),rep(2,16),rep(3,2))
dat.bm<-data.frame(rep(1,sum(dat[2,3:5])),rep(0,sum(dat[2,3:5])),
rep(NA,sum(dat[2,3:5])))
dat.bf[,3]<-c(rep(2,54),rep(2,7),rep(3,5))
dat.bm
dat
dat.bm<-data.frame(rep(1,sum(dat[2,3:5])),rep(0,sum(dat[2,3:5])),
rep(NA,sum(dat[2,3:5])))
dat.bf[,3]<-c(rep(1,54),rep(2,7),rep(3,5))
dat.bf<-data.frame(rep(1,sum(dat[1,3:5])),rep(1,sum(dat[1,3:5])),
rep(NA,sum(dat[1,3:5])))
dat.bf[,3]<-c(rep(1,88),rep(2,16),rep(3,2))
dat.bm<-data.frame(rep(1,sum(dat[2,3:5])),rep(0,sum(dat[2,3:5])),
rep(NA,sum(dat[2,3:5])))
dat.bm[,3]<-c(rep(1,54),rep(2,7),rep(3,5))
dat
names(dat.bf)<-letters[1:3]
dat.wf<-data.frame(rep(0,sum(dat[3,3:5])),rep(1,sum(dat[3,3:5])),
rep(NA,sum(dat[3,3:5])))
dat.wf[,3]<-c(rep(1,397),rep(2,141),rep(3,24))
names(dat.wf)<-letters[1:3]
dat.wf
tail(dat.wf)
at
dat.bf<-data.frame(rep(1,sum(dat[1,3:5])),rep(1,sum(dat[1,3:5])),
rep(NA,sum(dat[1,3:5])))
dat.bf[,3]<-c(rep(1,88),rep(2,16),rep(3,2))
names(dat.bf)<-letters[1:3]
dat.bm<-data.frame(rep(1,sum(dat[2,3:5])),rep(0,sum(dat[2,3:5])),
rep(NA,sum(dat[2,3:5])))
dat.bm[,3]<-c(rep(1,54),rep(2,7),rep(3,5))
names(dat.bm)<-letters[1:3]
dat.wf<-data.frame(rep(0,sum(dat[3,3:5])),rep(1,sum(dat[3,3:5])),
rep(NA,sum(dat[3,3:5])))
dat.wf[,3]<-c(rep(1,397),rep(2,141),rep(3,24))
names(dat.wf)<-letters[1:3]
dat.bm<-data.frame(rep(0,sum(dat[4,3:5])),rep(0,sum(dat[4,3:5])),
rep(NA,sum(dat[4,3:5])))
dat.bf[,3]<-c(rep(1,235),rep(2,189),rep(3,39))
names(dat.bf)<-letters[1:3]
dat.bm<-data.frame(rep(0,sum(dat[4,3:5])),rep(0,sum(dat[4,3:5])),
rep(NA,sum(dat[4,3:5])))
dat.bf<-data.frame(rep(1,sum(dat[1,3:5])),rep(1,sum(dat[1,3:5])),
rep(NA,sum(dat[1,3:5])))
dat.bf[,3]<-c(rep(1,88),rep(2,16),rep(3,2))
names(dat.bf)<-letters[1:3]
dat.bm<-data.frame(rep(1,sum(dat[2,3:5])),rep(0,sum(dat[2,3:5])),
rep(NA,sum(dat[2,3:5])))
dat.bm[,3]<-c(rep(1,54),rep(2,7),rep(3,5))
names(dat.bm)<-letters[1:3]
dat.wf<-data.frame(rep(0,sum(dat[3,3:5])),rep(1,sum(dat[3,3:5])),
rep(NA,sum(dat[3,3:5])))
dat.wf[,3]<-c(rep(1,397),rep(2,141),rep(3,24))
names(dat.wf)<-letters[1:3]
dat.wm<-data.frame(rep(0,sum(dat[4,3:5])),rep(0,sum(dat[4,3:5])),
rep(NA,sum(dat[4,3:5])))
dat.wm[,3]<-c(rep(1,235),rep(2,189),rep(3,39))
names(dat.bf)<-letters[1:3]
dat.ungrp<-rbind(dat.bf,dat.bm,dat.wf,dat.wm)
dat.ungrp<-rbind(dat.bf,dat.bm)
dat.ungrp<-rbind(dat.bf,dat.bm)
dat.ungrp<-rbind(dat.ungrp,dat.wf)
dat.ungrp<-rbind(dat.ungrp,dat.wm)
dat.ungrp<-rbind(dat.bf,dat.bm,dat.wf,dat.wm)
dat.wm
names(dat.wm)<-letters[1:3]
dat.wm
dat.bf<-data.frame(rep(1,sum(dat[1,3:5])),rep(1,sum(dat[1,3:5])),
rep(NA,sum(dat[1,3:5])))
dat.bf[,3]<-c(rep(1,88),rep(2,16),rep(3,2))
names(dat.bf)<-letters[1:3]
dat.bm<-data.frame(rep(1,sum(dat[2,3:5])),rep(0,sum(dat[2,3:5])),
rep(NA,sum(dat[2,3:5])))
dat.bm[,3]<-c(rep(1,54),rep(2,7),rep(3,5))
names(dat.bm)<-letters[1:3]
dat.wf<-data.frame(rep(0,sum(dat[3,3:5])),rep(1,sum(dat[3,3:5])),
rep(NA,sum(dat[3,3:5])))
dat.wf[,3]<-c(rep(1,397),rep(2,141),rep(3,24))
names(dat.wf)<-letters[1:3]
dat.wm<-data.frame(rep(0,sum(dat[4,3:5])),rep(0,sum(dat[4,3:5])),
rep(NA,sum(dat[4,3:5])))
dat.wm[,3]<-c(rep(1,235),rep(2,189),rep(3,39))
names(dat.wm)<-letters[1:3]
dat.ungrp<-rbind(dat.bf,dat.bm,dat.wf,dat.wm)
dat.ungrp
names(dat.ungrp)<-c("race","gender","y")
summary(vglm( y ~ gender+race, family=cumulative(parallel=T), data=dat.ungrp)
)
summary(vglm( y ~ gender+race, family=cumulative(parallel=T), data=dat.ungrp))
(vglm( y ~ gender+race, family=cumulative(parallel=T), data=dat.ungrp))
(vglm(cbind(y1,y2,y3) ~ gender+race, family=cumulative(parallel=T),data=dat) )
1-pchisq(1864,2390)
1-pchisq(9.254164,4)
rm(list = ls())
setwd("G:\\math\\661")
options(scipen=999)
require(ggplot2);library(MASS);library(VGAM)
cheese<-read.table("cheese.txt",header=T)
cheese.ungrp = as.data.frame(lapply(cheese, function(x,p) rep(x,p), cheese$count))
cheese.mat<-matrix(NA,4,9)
cheese.mat[1,]<-cheese[ 1:9,3]
cheese.mat[2,]<-cheese[ 10:18,3]
cheese.mat[3,]<-cheese[ 19:27,3]
cheese.mat[4,]<-cheese[ 28:36,3]
cheesy<-as.data.frame(cbind(c(1:4),cheese.mat),stringsAsFactors=F)
names(cheesy)<-c("type",paste0("Y",1:9))
for( i in 1:9){cheesy[,i+1]<-as.numeric(cheesy[,i+1]) }
summary(  polr(as.factor(response) ~ type, weights=count, data=cheese) )
summary( vglm(response ~ type, family=cumulative(parallel=TRUE),
data=cheese.ungrp) )
cheese
df.residual(vglm.fit )
df.residual(vglm.fit )
polr.fit=summary(  polr(as.factor(response) ~ type, weights=count, data=cheese) )
polr.fit
vglm.fit=summary( vglm(response ~ type, family=cumulative(parallel=TRUE),
data=cheese.ungrp) )
vglm.fit
vglm.fit
cheesy.fit=summary( vglm( cbind( Y1,Y2,Y3,Y4,Y5,Y6,Y7,Y8,Y9) ~
as.factor(type), family=cumulative(parallel=T) , data=cheesy) )
cheesy.fit
df.residual(polr.fit )
df.residual(vglm.fit )
df.residual(polr.fit )
polr.fit
(vglm( y ~ gender+race, family=cumulative(parallel=T), data=dat.ungrp))
dat<-data.frame(t(rep(1,5)))
dat[1,]<-c(1,1,88,16,2)
dat[2,]<-c(1,0,54,7,5)
dat[3,]<-c(0,1,397,141,24)
dat[4,]<-c(0,0,235,189,39)
names(dat)<-c("race" ,"gender", "y1", "y2", "y3")
(vglm(cbind(y1,y2,y3) ~ gender+race, family=cumulative(parallel=T),data=dat) )
dat
dat.bf<-data.frame(rep(1,sum(dat[1,3:5])),rep(1,sum(dat[1,3:5])),
rep(NA,sum(dat[1,3:5])))
dat.bf[,3]<-c(rep(1,88),rep(2,16),rep(3,2))
names(dat.bf)<-letters[1:3]
dat.bm<-data.frame(rep(1,sum(dat[2,3:5])),rep(0,sum(dat[2,3:5])),
rep(NA,sum(dat[2,3:5])))
dat.bm[,3]<-c(rep(1,54),rep(2,7),rep(3,5))
names(dat.bm)<-letters[1:3]
dat.wf<-data.frame(rep(0,sum(dat[3,3:5])),rep(1,sum(dat[3,3:5])),
rep(NA,sum(dat[3,3:5])))
dat.wf[,3]<-c(rep(1,397),rep(2,141),rep(3,24))
names(dat.wf)<-letters[1:3]
dat.wm<-data.frame(rep(0,sum(dat[4,3:5])),rep(0,sum(dat[4,3:5])),
rep(NA,sum(dat[4,3:5])))
dat.wm[,3]<-c(rep(1,235),rep(2,189),rep(3,39))
names(dat.wm)<-letters[1:3]
1-pchisq(1864,2390)
1-pchisq(9.254164,4)
dat.ungrp<-rbind(dat.bf,dat.bm,dat.wf,dat.wm)
names(dat.ungrp)<-c("race","gender","y")
<-rbind(dat.bf,dat.bm,dat.wf,dat.wm)
names(dat.ungrp
dat.ungrp
dat.ungrp
(vglm( y ~ gender+race, family=cumulative(parallel=T), data=dat.ungrp))
rowSums(cheese)
cheese
sum(cheese$count)
208*8-11
df.residual(polr.fit )
df.residual(vglm.fit )
dat
cheese
dat
dat.ungrp
dat
c(rep(1,6),rep(0,6))
c(rep(1,3),rep(0,3),rep(1,3),rep(0,3))
datt<-data.frame( c(rep(1,6),rep(0,6)),c(rep(1,3),rep(0,3),rep(1,3),rep(0,3)))
datt
names(datt)<-c("race","gender" )
datt
t
dat
datt
datt$y<-c(dat[1,3:5],dat[2,3:5],dat[3,3:5])
dat[1,3:5]
dat[2,3:5]
dat[3,3:5]
datt
dat
c(dat[1,3:5],dat[2,3:5],dat[3,3:5])
as.numeric( c(dat[1,3:5],dat[2,3:5],dat[3,3:5]) )
datt$y<-as.numeric( c(dat[1,3:5],dat[2,3:5],dat[3,3:5]) )
datt
dat
datt$y<-as.numeric( c(dat[1,3:5],dat[2,3:5],dat[3,3:5]),dat[4,3:5]) )
datt<-data.frame( c(rep(1,6),rep(0,6)),c(rep(1,3),rep(0,3),rep(1,3),rep(0,3)))
names(datt)<-c("race","gender" )
datt$y<-as.numeric( c(dat[1,3:5],dat[2,3:5],dat[3,3:5]),dat[4,3:5]) )
datt$y<-as.numeric( c(dat[1,3:5],dat[2,3:5],dat[3,3:5]),dat[4,3:5])
datt
as.numeric( c(dat[1,3:5],dat[2,3:5],dat[3,3:5]),dat[4,3:5])
datt$y<-as.numeric( c(dat[1,3:5],dat[2,3:5],dat[3,3:5] ,dat[4,3:5])  )
datt
polr(y ~ gender+race, family=cumulative(parallel=T), data=datt)
polr(as.factor(y) ~ gender+race, family=cumulative(parallel=T), data=datt)
as.factor(y)
polr(as.factor(y) ~ gender+race, family=cumulative(parallel=T), data=datt)
cheese
datt$y<-rep(1:3,4)
datt
datt$count<-as.numeric( c(dat[1,3:5],dat[2,3:5],dat[3,3:5] ,dat[4,3:5])  )
datt
polr(as.factor(y) ~ gender+race, weights = count , family=cumulative(parallel=T), data=datt)
library(MASS)
polr(as.factor(y) ~ gender+race, weights = count ,  data=datt)
df.residual(polr(as.factor(y) ~ gender+race, weights = count ,  data=datt) )
